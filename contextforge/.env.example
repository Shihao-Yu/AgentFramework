# ContextForge - Environment Configuration
# Copy this file to .env and fill in your values
# All environment variables use the CONTEXTFORGE_ prefix

# =============================================================================
# Application Settings
# =============================================================================
CONTEXTFORGE_APP_NAME="FAQ Knowledge Base"
CONTEXTFORGE_DEBUG=false

# =============================================================================
# Database Configuration
# =============================================================================
# PostgreSQL connection string (async driver)
# Format: postgresql+asyncpg://user:password@host:port/database
CONTEXTFORGE_DB_URL=postgresql+asyncpg://postgres:password@localhost:5432/knowledge_base

# Connection pool settings
CONTEXTFORGE_DB_POOL_SIZE=10
CONTEXTFORGE_DB_MAX_OVERFLOW=20
CONTEXTFORGE_DB_SCHEMA=agent

# =============================================================================
# Search Settings
# =============================================================================
# Weights for hybrid search (must sum to 1.0)
CONTEXTFORGE_SEARCH_BM25_WEIGHT=0.4
CONTEXTFORGE_SEARCH_VECTOR_WEIGHT=0.6

# Default number of results
CONTEXTFORGE_SEARCH_DEFAULT_LIMIT=10

# =============================================================================
# CORS Settings
# =============================================================================
# Comma-separated list of allowed origins, or "*" for all
CONTEXTFORGE_CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# =============================================================================
# OpenAI / LLM Configuration
# =============================================================================
# API key for OpenAI (required for embeddings and LLM)
CONTEXTFORGE_OPENAI_API_KEY=

# Optional: Custom base URL for OpenAI-compatible API
# CONTEXTFORGE_OPENAI_BASE_URL=

# Embedding model (default: text-embedding-3-small)
CONTEXTFORGE_EMBEDDING_MODEL=text-embedding-3-small
CONTEXTFORGE_EMBEDDING_DIMENSION=1536

# LLM model (default: gpt-4o-mini)
CONTEXTFORGE_LLM_MODEL=gpt-4o-mini

# =============================================================================
# Authentication (JWKS)
# =============================================================================
# Required for JWT-based authentication
# CONTEXTFORGE_AUTH_JWKS_URL=https://login.microsoftonline.com/{tenant}/discovery/v2.0/keys
# CONTEXTFORGE_AUTH_ISSUER=https://login.microsoftonline.com/{tenant}/v2.0
# CONTEXTFORGE_AUTH_AUDIENCE=api://your-app-id

# Optional: Fallback JWKS for ADFS
# CONTEXTFORGE_AUTH_FALLBACK_JWKS_URL=
# CONTEXTFORGE_AUTH_FALLBACK_ISSUER=

# =============================================================================
# Redis (optional, for caching)
# =============================================================================
# Redis Sentinel mode (comma-separated host:port pairs)
# CONTEXTFORGE_REDIS_SENTINEL_HOSTS=sentinel1:26379,sentinel2:26379
# CONTEXTFORGE_REDIS_SENTINEL_MASTER=mymaster
# CONTEXTFORGE_REDIS_PASSWORD=
# CONTEXTFORGE_REDIS_DB=0

# Graph cache settings
CONTEXTFORGE_GRAPH_CACHE_TTL=300
CONTEXTFORGE_GRAPH_CACHE_KEY_PREFIX=contextforge:graph

# =============================================================================
# Langfuse (optional, for prompt management)
# =============================================================================
# CONTEXTFORGE_LANGFUSE_PUBLIC_KEY=
# CONTEXTFORGE_LANGFUSE_SECRET_KEY=
# CONTEXTFORGE_LANGFUSE_HOST=https://cloud.langfuse.com

# =============================================================================
# Pipeline Settings
# =============================================================================
# Similarity thresholds
CONTEXTFORGE_PIPELINE_SIMILARITY_SKIP_THRESHOLD=0.95
CONTEXTFORGE_PIPELINE_SIMILARITY_VARIANT_THRESHOLD=0.85
CONTEXTFORGE_PIPELINE_SIMILARITY_MERGE_THRESHOLD=0.70

# Quality thresholds
CONTEXTFORGE_PIPELINE_CONFIDENCE_THRESHOLD=0.7
CONTEXTFORGE_PIPELINE_MIN_BODY_LENGTH=30
CONTEXTFORGE_PIPELINE_MIN_CLOSURE_NOTES_LENGTH=30

# =============================================================================
# Rate Limiting
# =============================================================================
CONTEXTFORGE_RATE_LIMIT_ENABLED=true
CONTEXTFORGE_RATE_LIMIT_DEFAULT_LIMIT=100
CONTEXTFORGE_RATE_LIMIT_DEFAULT_WINDOW=60
CONTEXTFORGE_RATE_LIMIT_SEARCH_LIMIT=200
CONTEXTFORGE_RATE_LIMIT_WRITE_LIMIT=50

# =============================================================================
# Maintenance
# =============================================================================
CONTEXTFORGE_VERSION_RETENTION_DAYS=90
CONTEXTFORGE_HIT_RETENTION_DAYS=365
